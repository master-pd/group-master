name: Setup Repository

on:
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  setup:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Create essential files
      run: |
        echo "ðŸ”§ Setting up repository..."
        
        # Create package-lock.json if missing
        if [ ! -f "package-lock.json" ]; then
          echo "ðŸ“¦ Generating package-lock.json..."
          npm init -y
          npm install node-telegram-bot-api
          echo "âœ… Created package-lock.json"
        fi
        
        # Create .gitignore if missing
        if [ ! -f ".gitignore" ]; then
          cat > .gitignore << 'EOF'
          # Dependencies
          node_modules/
          npm-debug.log
          
          # Environment
          .env
          config.json
          
          # Logs
          *.log
          logs/
          
          # Runtime data
          *.pid
          *.seed
          
          # IDE
          .vscode/
          .idea/
          
          # OS
          .DS_Store
          Thumbs.db
          
          # Temporary
          tmp/
          temp/
          
          # Backup files
          *.bak
          EOF
          echo "âœ… Created .gitignore"
        fi
        
        # Create README if missing
        if [ ! -f "README.md" ]; then
          cat > README.md << 'EOF'
          # Group Master Telegram Bot
          
          ðŸ¤– Advanced Telegram Group Management Bot running on GitHub Actions
          
          ## Features
          - âœ… 24/7 uptime (GitHub Actions)
          - âœ… Auto-restart every 30 minutes
          - âœ… No server required
          - âœ… Completely free
          
          ## Setup
          1. Fork this repository
          2. Add your BOT_TOKEN to GitHub Secrets
          3. Enable GitHub Actions
          4. Bot will auto-start
          
          ## GitHub Secrets Required
          - `BOT_TOKEN`: Your Telegram bot token from @BotFather
          
          ## Commands
          - `/start` - Start bot
          - `/help` - Show help
          - `/ping` - Check status
          - `/status` - Detailed status
          
          ## Note
          This bot runs on GitHub Actions free tier (2000 minutes/month).
          It auto-restarts every 30 minutes to avoid timeout.
          
          Made with â¤ï¸ by MAR-PD
          EOF
          echo "âœ… Created README.md"
        fi
        
    - name: Verify setup
      run: |
        echo "âœ… Repository setup complete"
        echo "ðŸ“ Files created:"
        ls -la
